{"ast":null,"code":"let socket = null;\nlet isConnected = false;\nconst messageQueue = [];\nfunction connectWebSocket() {\n  socket = new WebSocket(\"ws://localhost:8080\");\n  socket.onopen = () => {\n    console.log(\"‚úÖ WebSocket connesso\");\n    isConnected = true;\n\n    // Invia tutti i messaggi rimasti in coda\n    while (messageQueue.length > 0) {\n      const msg = messageQueue.shift();\n      console.log(\"üì§ Invio messaggio in coda:\", msg);\n      socket.send(msg);\n    }\n  };\n  socket.onmessage = event => {\n    const data = JSON.parse(event.data);\n    console.log(\"üì• Messaggio ricevuto:\", data);\n  };\n  socket.onerror = error => {\n    console.error(\"‚ùå Errore WebSocket:\", error);\n  };\n  socket.onclose = () => {\n    console.warn(\"‚ö†Ô∏è WebSocket chiuso. Riconnessione tra 2 secondi...\");\n    isConnected = false;\n    setTimeout(connectWebSocket, 2000); // Riprova la connessione\n  };\n}\n\n// Avvia la connessione subito\nconnectWebSocket();\n\n// Funzione di invio messaggi\nexport function sendMessage(obj) {\n  const msg = JSON.stringify(obj);\n  if (isConnected && socket.readyState === WebSocket.OPEN) {\n    console.log(\"üì§ Invio messaggio:\", msg);\n    socket.send(msg);\n  } else {\n    console.warn(\"‚è≥ WebSocket non ancora connesso, accodo:\", msg);\n    messageQueue.push(msg);\n  }\n}","map":{"version":3,"names":["socket","isConnected","messageQueue","connectWebSocket","WebSocket","onopen","console","log","length","msg","shift","send","onmessage","event","data","JSON","parse","onerror","error","onclose","warn","setTimeout","sendMessage","obj","stringify","readyState","OPEN","push"],"sources":["C:/Users/asche/Desktop/PoliTo/ThesisProject/Control panel/BraveProject_FDV/control-panel/src/websocket.js"],"sourcesContent":["let socket = null;\r\nlet isConnected = false;\r\nconst messageQueue = [];\r\n\r\nfunction connectWebSocket() {\r\n  socket = new WebSocket(\"ws://localhost:8080\");\r\n\r\n  socket.onopen = () => {\r\n    console.log(\"‚úÖ WebSocket connesso\");\r\n    isConnected = true;\r\n\r\n    // Invia tutti i messaggi rimasti in coda\r\n    while (messageQueue.length > 0) {\r\n      const msg = messageQueue.shift();\r\n      console.log(\"üì§ Invio messaggio in coda:\", msg);\r\n      socket.send(msg);\r\n    }\r\n  };\r\n\r\n  socket.onmessage = (event) => {\r\n    const data = JSON.parse(event.data);\r\n    console.log(\"üì• Messaggio ricevuto:\", data);\r\n  };\r\n\r\n  socket.onerror = (error) => {\r\n    console.error(\"‚ùå Errore WebSocket:\", error);\r\n  };\r\n\r\n  socket.onclose = () => {\r\n    console.warn(\"‚ö†Ô∏è WebSocket chiuso. Riconnessione tra 2 secondi...\");\r\n    isConnected = false;\r\n    setTimeout(connectWebSocket, 2000); // Riprova la connessione\r\n  };\r\n}\r\n\r\n// Avvia la connessione subito\r\nconnectWebSocket();\r\n\r\n// Funzione di invio messaggi\r\nexport function sendMessage(obj) {\r\n  const msg = JSON.stringify(obj);\r\n\r\n  if (isConnected && socket.readyState === WebSocket.OPEN) {\r\n    console.log(\"üì§ Invio messaggio:\", msg);\r\n    socket.send(msg);\r\n  } else {\r\n    console.warn(\"‚è≥ WebSocket non ancora connesso, accodo:\", msg);\r\n    messageQueue.push(msg);\r\n  }\r\n}"],"mappings":"AAAA,IAAIA,MAAM,GAAG,IAAI;AACjB,IAAIC,WAAW,GAAG,KAAK;AACvB,MAAMC,YAAY,GAAG,EAAE;AAEvB,SAASC,gBAAgBA,CAAA,EAAG;EAC1BH,MAAM,GAAG,IAAII,SAAS,CAAC,qBAAqB,CAAC;EAE7CJ,MAAM,CAACK,MAAM,GAAG,MAAM;IACpBC,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;IACnCN,WAAW,GAAG,IAAI;;IAElB;IACA,OAAOC,YAAY,CAACM,MAAM,GAAG,CAAC,EAAE;MAC9B,MAAMC,GAAG,GAAGP,YAAY,CAACQ,KAAK,CAAC,CAAC;MAChCJ,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEE,GAAG,CAAC;MAC/CT,MAAM,CAACW,IAAI,CAACF,GAAG,CAAC;IAClB;EACF,CAAC;EAEDT,MAAM,CAACY,SAAS,GAAIC,KAAK,IAAK;IAC5B,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACC,IAAI,CAAC;IACnCR,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAEO,IAAI,CAAC;EAC7C,CAAC;EAEDd,MAAM,CAACiB,OAAO,GAAIC,KAAK,IAAK;IAC1BZ,OAAO,CAACY,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;EAC7C,CAAC;EAEDlB,MAAM,CAACmB,OAAO,GAAG,MAAM;IACrBb,OAAO,CAACc,IAAI,CAAC,qDAAqD,CAAC;IACnEnB,WAAW,GAAG,KAAK;IACnBoB,UAAU,CAAClB,gBAAgB,EAAE,IAAI,CAAC,CAAC,CAAC;EACtC,CAAC;AACH;;AAEA;AACAA,gBAAgB,CAAC,CAAC;;AAElB;AACA,OAAO,SAASmB,WAAWA,CAACC,GAAG,EAAE;EAC/B,MAAMd,GAAG,GAAGM,IAAI,CAACS,SAAS,CAACD,GAAG,CAAC;EAE/B,IAAItB,WAAW,IAAID,MAAM,CAACyB,UAAU,KAAKrB,SAAS,CAACsB,IAAI,EAAE;IACvDpB,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEE,GAAG,CAAC;IACvCT,MAAM,CAACW,IAAI,CAACF,GAAG,CAAC;EAClB,CAAC,MAAM;IACLH,OAAO,CAACc,IAAI,CAAC,0CAA0C,EAAEX,GAAG,CAAC;IAC7DP,YAAY,CAACyB,IAAI,CAAClB,GAAG,CAAC;EACxB;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}